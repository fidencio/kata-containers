From 8cab51691c289cf983f864ffcd79d37a29db22d5 Mon Sep 17 00:00:00 2001
From: Dave Jiang <dave.jiang@intel.com>
Date: Wed, 23 Mar 2022 17:23:24 -0700
Subject: [PATCH 1235/1418] crypto: iax: fix usage of uninit ptr in
 iax_compress() call

Cc: Tom Zanussi <tom.zanussi@intel.com>
Signed-off-by: Dave Jiang <dave.jiang@intel.com>
---
 drivers/crypto/iax/iax_crypto_main.c | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

diff --git a/drivers/crypto/iax/iax_crypto_main.c b/drivers/crypto/iax/iax_crypto_main.c
index 5adf73fb7797..aa2c4bb6c4c0 100644
--- a/drivers/crypto/iax/iax_crypto_main.c
+++ b/drivers/crypto/iax/iax_crypto_main.c
@@ -697,9 +697,10 @@ static int iax_compress(struct crypto_tfm *tfm,
 	idxd_desc = idxd_alloc_desc(wq, IDXD_OP_BLOCK);
 	if (IS_ERR(idxd_desc)) {
 		pr_err("%s: idxd descriptor allocation failed\n", __func__);
-		pr_warn("%s: iax compress (verify) failed: ret=%ld\n", __func__, PTR_ERR(desc));
+		pr_warn("%s: iax compress (verify) failed: ret=%ld\n", __func__,
+			PTR_ERR(idxd_desc));
 
-		return PTR_ERR(desc);
+		return PTR_ERR(idxd_desc);
 	}
 	desc = idxd_desc->iax_hw;
 
-- 
2.31.1

